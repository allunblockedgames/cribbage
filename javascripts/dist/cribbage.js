!function(){var t={7967:function(t,e,n){var r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,i=/^0o[0-7]+$/i,s=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,l=c||u||Function("return this")(),d=Object.prototype.toString,f=Math.max,g=Math.min,m=function(){return l.Date.now()};function h(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function v(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==d.call(t)}(t))return NaN;if(h(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=h(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var n=a.test(t);return n||i.test(t)?s(t.slice(2),n?2:8):o.test(t)?NaN:+t}t.exports=function(t,e,n){var r,o,a,i,s,c,u=0,l=!1,d=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function w(e){var n=r,a=o;return r=o=void 0,u=e,i=t.apply(a,n)}function S(t){var n=t-c;return void 0===c||n>=e||n<0||d&&t-u>=a}function y(){var t=m();if(S(t))return b(t);s=setTimeout(y,function(t){var n=e-(t-c);return d?g(n,a-(t-u)):n}(t))}function b(t){return s=void 0,p&&r?w(t):(r=o=void 0,i)}function T(){var t=m(),n=S(t);if(r=arguments,o=this,c=t,n){if(void 0===s)return function(t){return u=t,s=setTimeout(y,e),l?w(t):i}(c);if(d)return s=setTimeout(y,e),w(c)}return void 0===s&&(s=setTimeout(y,e)),i}return e=v(e)||0,h(n)&&(l=!!n.leading,a=(d="maxWait"in n)?f(v(n.maxWait)||0,e):a,p="trailing"in n?!!n.trailing:p),T.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=c=o=s=void 0},T.flush=function(){return void 0===s?i:b(m())},T}},5495:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{c(r.next(t))}catch(t){a(t)}}function s(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.CribbagePersonalStats=void 0;const o=n(6910),a=n(9824),i={streakCount:0,streakLastTimestamp:0};class s extends o.PersonalStats{constructor(t){super(t,"personal-stats-cribbage",i)}winGame(){return r(this,void 0,void 0,(function*(){const t=yield this.getStats();return this.incrementOrResetStreak(t),this.saveStats(t)}))}loseGame(){return r(this,void 0,void 0,(function*(){const t=yield this.getStats();return this.incrementOrResetStreak(t),this.saveStats(t)}))}incrementOrResetStreak(t){const e=(0,a.getCurrentDate)(),n=new Date(t.streakLastTimestamp),r=(0,a.getDaysDiff)(n,e);return 1===r?t.streakCount++:r>1&&(t.streakCount=1),t.streakLastTimestamp=e.getTime(),t}getDisplayStats(){return r(this,void 0,void 0,(function*(){return yield this.getStats()}))}}e.CribbagePersonalStats=s},6429:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.hasValidStoredGame=function(t){if(t.indexOf("replay=true")>-1)return!1;const e=c();return!!(e&&e.url===t&&i.indexOf(nameSlug)>-1)},e.deleteStoredGameState=s,e.restoreGameState=c,e.serializeCard=u,e.serializeGameState=l,e.storeGameState=function(t,e){if(o.default.gameWon)return void s();const n=l(t,e);try{localStorage.setItem("gameState",JSON.stringify(n))}catch(t){console.log(t)}};const o=r(n(867)),a="gameState",i=["klondike-turn-1","klondike-turn-3","las-vegas-klondike","las-vegas-klondike-turn-3","spider-one-suit","spider-two-suits","spider-four-suits","freecell"];function s(){try{localStorage.removeItem(a)}catch(t){console.log(t)}}function c(){try{const t=localStorage.getItem(a);if(t)return JSON.parse(t)}catch(t){console.log(t)}return null}function u(t){return{name:t.name,turnedup:t.turnedup}}function l(t,e){const n=t.reduce(((t,e)=>{const n=e.piles.map((t=>t.map((t=>u(t)))));return t.cardAreas[e.name]=n,t}),{cardAreas:{}});return Object.assign(Object.assign({},n),e)}},6910:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{c(r.next(t))}catch(t){a(t)}}function s(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.PersonalStats=void 0;const o=n(9824);class a{constructor(t,e,n){this.initialFetchFailed=!1,this.storageKey=e,this.defaultState=n,this.shouldSaveToServer=t,this.shouldSaveToServer?this.initialServerFetchPromise=this.fetchFromServer():this.initialServerFetchPromise=Promise.resolve()}cloneStat(){return JSON.parse(JSON.stringify(this.defaultState))}getStats(){return r(this,void 0,void 0,(function*(){return this.initialServerFetchPromise.then((()=>{try{const t=localStorage.getItem(this.storageKey);if(!t)return this.cloneStat();const e=JSON.parse(t);return Object.assign(Object.assign({},this.defaultState),e)}catch(t){return console.log(t),this.cloneStat()}}))}))}saveStats(t){return r(this,void 0,void 0,(function*(){const e=this.setLocalState(t);if(this.shouldSaveToServer)return this.saveToServer(e)}))}setLocalState(t){const e=Object.assign(Object.assign({},this.defaultState),t);try{const t=JSON.stringify(e);return localStorage.setItem(this.storageKey,t),JSON.parse(t)}catch(t){(0,o.recordError)(t)}return e}saveToServer(t){return new Promise(((e,n)=>{if(this.initialFetchFailed)return e();$.ajax({type:"POST",url:`/personal-stats/${this.storageKey}`,contentType:"application/json; charset=utf-8",data:JSON.stringify(t),complete:()=>{e()}})}))}fetchFromServer(){return r(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{$.ajax({url:`/personal-stats/${this.storageKey}`,type:"GET",success:e=>{if("ok"!==e.status&&(this.initialFetchFailed=!0,(0,o.recordError)(new Error(`error saving ${this.storageKey}`))),e.data){const t=e.data;this.setLocalState(t)}else this.setLocalState(this.defaultState);t()},error:()=>{this.initialFetchFailed=!0,this.setLocalState(this.defaultState),t()},timeout:5e3})}))}))}isEmpty(){try{return!localStorage.getItem(this.storageKey)}catch(t){console.log(t)}return!1}static getLocalStorageKeys(){const t=[];try{for(let e=0;e<localStorage.length;e++){const n=localStorage.key(e);(this.PERSONAL_STATS_KEYS.includes(n)||n.startsWith(this.PERSONAL_STATS_KEY_PREFIX))&&t.push(n)}}catch(t){(0,o.recordError)(t)}return t}static clearLocalStorage(){try{this.getLocalStorageKeys().forEach((t=>localStorage.removeItem(t)))}catch(t){(0,o.recordError)(t)}}static saveAllToServer(){try{const t=this.getLocalStorageKeys();let e=[Promise.resolve()];return t.forEach((t=>{const n=JSON.parse(localStorage.getItem(t)),r=new Promise(((e,r)=>{$.ajax({type:"POST",url:`/personal-stats/${t}`,contentType:"application/json; charset=utf-8",data:JSON.stringify(n),complete:e,error:e})}));e.push(r)})),Promise.all(e)}catch(t){(0,o.recordError)(t)}}}e.PersonalStats=a,a.PERSONAL_STATS_KEYS=["yahtzee"],a.PERSONAL_STATS_KEY_PREFIX="personal-stats-"},9824:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isLocalEnv=function(){var t,e;return"localhost"===(null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.hostname)||"local.solitaired.com"===(null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.hostname)},e.isDebug=function(){return null===window||void 0===window?void 0:window.location.href.includes("debug=true")},e.isStagingEnv=function(){var t;return"dev.solitaired.com"===(null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.hostname)},e.tryGetValueFromLocalStorage=a,e.tryClearValueFromLocalStorage=function(t){try{return localStorage.removeItem(t)}catch(t){console.log(t)}},e.trySetValueInLocalStorage=function(t,e){try{localStorage.setItem(t,e)}catch(t){console.log(t)}},e.timeUntilMidnightUTC=function(){const t=new Date,e=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()+1,0,0,0).getTime()-t.getTime();return new Date(e).toISOString().substr(11,8)},e.onIdle=function(t,e){let n;t=t||3e4;const r=()=>{clearTimeout(n),n=setTimeout((()=>{e()}),t)},a=o(r,1e3,{leading:!0,maxWait:1e3,trailing:!1});$((()=>{a(),$(document).on("mousemove",a),$(document).on("keypress",r),$(document).on("mousedown",r),$(document).on("touchstart",r),$(document).on("touchmove",a)}))},e.getCurrentDate=function(){const t=new Date;return t.setHours(0,0,0,0),t},e.getDaysDiff=function(t,e){return Math.floor((e.getTime()-t.getTime())/864e5)},e.convertCardToSymbolText=function(t){let e=(t="string"==typeof t?t:t.name).split("_");return`<span style="color: ${c[e[0]]}">${i[e[0]]}</span><span style="color: ${c[e[0]]}">${s[e[1]]}</span>`},e.postWithRetry=function(t,e,n,r){let o=0;return $.post({url:t,data:e,success:function(n){o>0&&m(new Error("request succeeded on retry"),{url:t,data:e,attemptCount:o}),r(n)},error:function(r,a,i){o++,o<=n?setTimeout((()=>{$.ajax(this)}),2e3):m(new Error(`POST to ${t} failed`),{textStatus:a,status:r.status,data:e,errorThrown:i})}})},e.checkTestBucket=function(t,e){return!!("undefined"!=typeof abTest&&abTest.run&&abTest.name&&abTest.name.length>0)&&("number"!=typeof e?t===abTest.name:t===abTest.name&&e===abTest.bucket)},e.modalOnScreen=function(){return $(".modal, #congrats").toArray().some((t=>"none"!=window.getComputedStyle(t).display))},e.bodyHasFocus=function(){return document.activeElement==document.body},e.preventAccidentalNavigation=function(t){u||a("disablePreventAccidentalNav")||($("#canvas").length>0&&$("#canvas")[0].addEventListener("touchstart",(t=>{if(t.preventDefault(),"undefined"!=typeof shownAd1&&!1===shownAd1&&"undefined"!=typeof waitToShowAd)try{waitToShowAd()}catch(t){console.log("ad error occurred.")}})),$("#timerContainer").length>0&&$("#timerContainer")[0].addEventListener("touchstart",(t=>{if(!t.target)return;let e=t.target;["timerContainer","gameMenuCol","gameName"].includes(e.id)&&t.preventDefault()})),$(document).on("click","#newGameDropdown a, .nav-item a, .skip-prevent-accidental-nav",(function(){(0,r.deleteStoredGameState)(),l=!0})),$(document).on("click",".turn-btns a",(function(){(0,r.deleteStoredGameState)()})),window.addEventListener("beforeunload",(function(e){!t.gameStarted||t.gameWon||l||(e.preventDefault(),e.returnValue="",(0,r.deleteStoredGameState)(),window.unloadPrevented=!0)})),u=!0)},e.sendDebugReport=function(t,e){if(!d)try{const n=function(){if(!window.consoleErrors)return[];try{return window.consoleErrors.filter((t=>t[0].indexOf("javascripts/dist")>-1))}catch(t){return["Error parsing errors"]}}();$.post("/debug",{game:t,payload:e,errors:n,abTest:abTest}),d=!0}catch(t){m(t)}},e.isMobile=function(){return window.innerWidth<450},e.recordError=m,e.randomInRange=function(t,e){return Math.random()*(e-t)+t},e.enterFullScreen=function(t){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),window.setTimeout((function(){$(window).resize()}),100)},e.exitFullScreen=function(){if(document.fullscreenElement)try{const t=document;t.exitFullscreen?t.exitFullscreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.msExitFullscreen&&t.msExitFullscreen(),window.setTimeout((function(){$(window).resize()}),100)}catch(t){window.recordError(t)}},e.createMobileCard=function(t,e){return`/images/style-classic-mobile/${t}_${e}.png`},e.getBackRedCard=function(){return"/images/style-classic-mobile/back_red.png"};const r=n(6429);var o=n(7967);function a(t){try{return localStorage.getItem(t)}catch(t){console.log(t)}return null}const i={heart:"&hearts;",diamond:"&diams;",club:"&clubs;",spade:"&spades;"},s={1:"A",2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:"J",12:"Q",13:"K"},c={heart:"#ff0000",diamond:"#ff0000",club:"#000000",spade:"#000000"};let u=!1,l=!1,d=!1,f=0;const g=/ima is not a function/;function m(t,e={}){try{consoleErrors.push([t.message,t.stack]),f<5&&!g.test(t.message)&&($.post("/stream/record-error",{eventMessage:t.message,errorMessage:t.message,stackStrace:t.stack,extras:e}),f++)}catch(t){console.log("recordError error",t)}}},867:function(t,e){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),"undefined"!=typeof gsap&&(gsap.ticker.lagSmoothing(1/0),location.href.indexOf("showDeltaRatio=true")>-1&&gsap.ticker.add((function(){console.log("FPS delay ratio: "+gsap.ticker.deltaRatio())})));let o={dispatch:t=>{setTimeout((()=>{window.dispatchEvent(t)}),0)},finishGameEvent:new Event("gameVars.finishGameEvent"),images_canvas:{},waterfallRunning:!1,globalWindow:{}};o.imagesLoaded=new Event("gameVars.imagesLoaded"),o.congratsNextCardEvent=new Event("gameVars.congratsNextCardEvent"),o.animateDeal=new Event("gameVars.animateDeal"),o.dealAnimationFinished=new Event("gameVars.dealAnimationFinished"),o.dropCompleted=new Event("gameVars.dropCompleted"),o.triggerNextUndo=new Event("gameVars.triggerNextUndo"),o.gameWonEvent=new Event("gameVars.gameWonEvent"),o.isNewGame=!0,o.clickStart,o.clickType="",o.cardWidth,o.cardHeight,o.cardSpacing,o.cardStep,o.cardXOffset=0,o.moveCounter,o.cardsSprite,o.flashMessage="",o.gameStarted=!1,o.isRestoredGame=!1,o.previousMoves=[],o.defaultCardFactors={spacing:.03,width:.69,height:"undefined"==typeof factorHeight?1.45:factorHeight,stepMax:.175},o.cardFactors=Object.assign({},o.defaultCardFactors),o.float=[],o.flip=[],o.fromSet={},o.turns=0,o.passthroughs=0,o.stockCount=0,o.gameWon=!1,o.lock={},o.softLock={},o.images={},o.canvas=document.getElementById("canvas"),o.contextOptions={},!0===(null===(n=null===window||void 0===window?void 0:window.SOLITAIRED_GLOBAL)||void 0===n?void 0:n.willReadFrequently)&&(o.contextOptions.willReadFrequently=!0),o.ctx=null===(r=o.canvas)||void 0===r?void 0:r.getContext("2d",o.contextOptions),"string"==typeof seed&&"string"==typeof nameSlug&&(o.storageKey=`moves-${nameSlug}`),o.getDeltaRatioDuration=t=>gsap.ticker.deltaRatio()>3?.01:t,o.getCleanCards=()=>{let t=[];for(let e of o.allAreas)for(let n of e.piles)for(let e of n){const n=`${e.name}_h:${+e.hide}`;t.push(n)}return t},o.getCanvasInfo=()=>Object.keys(o.images_canvas).reduce(((t,e)=>{const n=o.images_canvas[e],r=n.getContext("2d");return r?(r.getImageData(n.width/3,n.height/2,1,1).data[3]>0||t.push(`[${e}: canvas is blank] `),t):(t.push(`[${e}: ctx is null] `),t)}),[]),o.getAllCards=()=>{let t=[];t.push(o.float);for(let e=0;e<o.allAreas.length;e++)t.push(o.allAreas[e].piles);return t},e.default=o,window.getCleanCards=o.getCleanCards,window.getCanvasInfo=o.getCanvasInfo,window.getLocks=function(){return JSON.stringify(o.lock)},window.getClickType=function(){return o.clickType}},5617:function(t,e,n){"use strict";var r,o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{c(r.next(t))}catch(t){a(t)}}function s(t){try{c(r.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const a=n(5495);globalThis.game=new Game,ShowStartAGameMenu(!0),window.onload=function(){UpdateBackgroundImageFromSettings()},"function"==typeof startFn?startFn():startFn=!0;const i=new a.CribbagePersonalStats(null===(r=window.SOLITAIRED_GLOBAL)||void 0===r?void 0:r.loggedInUser);window.cribbageApi={winGame:i.winGame.bind(i),loseGame:i.loseGame.bind(i),showStatisticsMenu:()=>o(void 0,void 0,void 0,(function*(){const t=yield i.getDisplayStats();$("#dailyPlayStreak").text(t.streakCount),$("#menu_statistics").modal("show")}))},window.SOLITAIRED_GLOBAL||$((()=>{const t=()=>{if($(window).off("click touchstart",t),window.lngtdStart)try{window.lngtdStart()}catch(t){console.log("Lngtd start error: ",t)}else setTimeout(t,100)};$(window).on("click touchstart",t)}))}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r].call(a.exports,a,a.exports,n),a.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n(5617)}();